体彩竞猜功能实现说明
========================
版本更新加v 1997835 注明世界杯


=========================
版本更新加v 1997835 注明世界杯
版本更新加v 1997835 注明世界杯
版本更新加v 1997835 注明世界杯
版本更新加v 1997835 注明世界杯
版本更新加v 1997835 注明世界杯

=========================
版本更新加v 1997835 注明世界杯
版本更新加v 1997835 注明世界杯
版本更新加v 1997835 注明世界杯
版本更新加v 1997835 注明世界杯
版本更新加v 1997835 注明世界杯

一、功能概述
已成功实现体彩三种玩法的展示和投注功能:
1. 胜负平玩法 (主胜/平局/客胜)
2. 总进球数玩法 (0-7+球)
3. 比分玩法 (常见比分预测)

二、已修改的文件

1. /Users/wang/Desktop/1/My/Home/View/Index/index.html
   - 在赛事卡片中添加体彩玩法标识
   - 显示启用的体彩玩法类型标签

2. /Users/wang/Desktop/1/My/Home/View/Index/detail.html
   - Phone版本:添加三个体彩玩法的完整显示区域
   - PC版本:添加三个体彩玩法的完整显示区域
   - 添加体彩赔率采集JavaScript函数 (fetchSPF, fetchJinqiu, fetchBifen)
   - 每个体彩玩法都有独立的投注按钮

3. /Users/wang/Desktop/1/My/Home/Controller/IndexController.class.php
   - 添加 fetchTcOdds() 方法处理体彩赔率采集
   - 支持三种玩法的赔率数据采集
   - 模拟从官网采集赔率数据

三、数据库字段要求

h_saishi 表需要包含以下字段:
- enable_play_spf (tinyint): 是否启用胜负平玩法
- spf_home_odds (decimal): 主胜赔率
- spf_draw_odds (decimal): 平局赔率
- spf_away_odds (decimal): 客胜赔率
- enable_play_jinqiu (tinyint): 是否启用总进球数玩法
- jq_0 到 jq_7 (decimal): 0-7+球的赔率
- enable_play_bifen (tinyint): 是否启用比分玩法
- bifen_odds (text): 比分赔率JSON数据

四、使用方法

1. 后台管理 (赛事编辑):
   - 进入"赛事管理" -> "赛事编辑"
   - 在"体彩玩法配置"区域勾选要启用的玩法
   - 点击"从体彩官网采集赔率"按钮自动采集赔率
   - 也可以手动输入赔率值
   - 保存后前端即可看到相应玩法

2. 前端投注:
   - 用户进入赛事详情页面
   - 可以看到已启用的体彩玩法
   - 点击对应赔率进行投注
   - 投注流程与现有玩法一致

五、前端展示效果

1. index.html 首页:
   - 赛事卡片上显示体彩玩法标签
   - 标签颜色区分:
     * 胜负平: 蓝色 (#0585a1)
     * 总进球: 橙色 (#e67e22)
     * 比分: 绿色 (#27ae60)

2. detail.html 详情页:
   - Phone版本: 纵向排列,每个玩法独占一个区域
   - PC版本: 网格布局,总进球和比分显示为4列网格
   - 赔率按钮样式与现有玩法保持一致
   - 封盘状态显示"封盘"文字

六、注意事项

1. 体彩赔率采集功能目前使用模拟数据
   - 实际部署时需要接入真实的体彩官网API
   - 可以在 fetchTcOdds() 方法中修改为真实API调用

2. 投注处理复用现有的投注逻辑
   - 体彩投注使用相同的 paytouzhu() 方法
   - changci 参数统一使用 1
   - type 参数根据选择项而定

3. 数据库初始化
   - 需要先执行 add_tc_fields.sql 添加字段
   - 或者在已有赛事上手动添加体彩赔率数据

七、测试建议

1. 后台测试:
   - 添加或编辑一场赛事
   - 勾选体彩玩法
   - 采集或手动输入赔率
   - 保存后检查数据库数据

2. 前端测试:
   - 查看首页是否显示体彩标签
   - 进入详情页查看体彩玩法区域
   - 点击投注按钮测试投注流程
   - 检查封盘状态显示是否正常

3. 兼容性测试:
   - 测试Phone版本显示
   - 测试PC版本显示
   - 测试不同浏览器兼容性
